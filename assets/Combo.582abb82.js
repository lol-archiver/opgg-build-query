import{_ as se,c as r,k as _,r as d,l as j,o as oe,m as ue,b as f,d as p,u as o,i as $,n as b,t as H,f as y,w as ie,v as re,e as de,q as ce,F as G,h as J,p as fe,j as pe}from"./index.12f193bf.js";import{p as ve,s as ye}from"./label.51a802a6.js";import me from"./Texter.46606726.js";const K=u=>(fe("data-v-92562334"),u=u(),pe(),u),he=["checked"],be=["hide-outline","only"],Se=["value","placeholder","tabindex","disabled"],ke=K(()=>y("p-tip",null,"\u641C\u7D22",-1)),ge={key:0,selected:""},we=K(()=>y("p-tip",null,"\u5DF2\u9009",-1)),Ve=["selected","title","onClick"],_e=K(()=>y("p-tip",null,"\u672A\u9009",-1)),$e=["selected","title","onClick"],xe={__name:"Combo",props:{modelValue:{type:[String,Number,Boolean,Array,Object],default:""},disable:{type:Boolean,default:!1},text:{type:String,default:""},default:{type:[String,Number,Boolean],default:""},...ve,disabling:{type:[String,Boolean],default:!1},readonly:{type:[String,Boolean],default:!1},place:{type:[Number,String],default:""},tab:{type:[Number,String],default:0},align:{type:String,default:null},list:{type:Array,default:()=>[]},filter:{type:[String,Boolean,Function],default:!1},multiSelect:{type:[String,Boolean],default:!1},keyShow:{type:[String,Function,Array],default:"text"},keyValue:{type:String,default:"value"}},emits:["update:modelValue","update:disable","update:value"],setup(u,{emit:g}){const a=u,S=r(()=>a.multiSelect==="array"?a.multiSelect:_(a.multiSelect)),c=r(()=>_(a.disabling)),P=r(()=>_(a.readonly)),{label_:x,labelWidth_:Q,labelAlign_:X}=ye(a,c),Y=r(()=>({width:Q.value,textAlign:X.value})),m=d(c.value&&a.modelValue===!1?a.default:a.modelValue),i=d(c.value?a.modelValue===!1:a.disable);j(()=>a.disable,e=>{c.value||(i.value=e)}),j(()=>a.modelValue,e=>{c.value?e===!1?i.value=!0:(i.value=!1,m.value=e):m.value=e}),j([m,i],([e,t],[l,n])=>{c.value?(e!=l&&g("update:value",e),t!=n&&g("update:disable",t),g("update:modelValue",t===!0?!1:e)):g("update:modelValue",e)});const C=r(()=>{const e=m.value;return S.value?e instanceof Array?e.filter(t=>t):e?String(e).split(",").map(t=>t.trim()).filter(t=>t):[]:[e]}),A=(e,t)=>t===null||typeof t>"u"||typeof t=="boolean"?e===t:e==t,Z=e=>{const t=C.value,l=a.keyValue=="$$"?e:e[a.keyValue];return S.value?!!~t.findIndex(n=>A(n,l)):A(t[0],l)},B=d(""),L=r(()=>typeof a.filter=="function"?a.filter:_(a.filter)),O=(e,t,l)=>{var v,V,R;const n=(V=(v=B.value)==null?void 0:v.trim())!=null?V:"",s=L.value;return s?typeof s=="function"?s(n,e.data,e,t,l):(R=h(e.data))==null?void 0:R.includes(n):!0},M=r(()=>a.list),D=r(()=>M.value.map(e=>({selected:Z(e),data:e}))),W=r(()=>D.value.filter(e=>e.selected)),N=r(()=>D.value.filter(e=>!e.selected).filter((e,t,l)=>O(e,t,l)).filter(e=>{var t;return!((t=e.data)!=null&&t.hidden)})),h=(e,t=0)=>{var n,s;const l=a.keyShow instanceof Array?a.keyShow[t]:a.keyShow;return typeof l=="function"?(n=l(e))!=null?n:"":(s=e==null?void 0:e[l])!=null?s:""},ee=r(()=>C.value.map(e=>h(M.value.find(t=>A(a.keyValue=="$$"?t:t==null?void 0:t[a.keyValue],e)),1)).join("\u3001")),w=d(null),q=d(null),k=d(null),E=d(""),T=d(""),F=d(!1),te=()=>{F.value=!0},le=()=>{F.value=!1},I=d(!1),ae=()=>{k.value.state.isShown?k.value.hide():(E.value="auto",T.value=window.getComputedStyle(w.value).width,k.value.show(),I.value=!I.value)},U=e=>{var t;e.selected=!0,m.value=a.keyValue=="$$"?e.data:(t=e.data)==null?void 0:t[a.keyValue],k.value.hide()},z=e=>{var t;if(S.value){e.selected=!!e.selected;const l=a.keyValue=="$$"?e.data:(t=e.data)==null?void 0:t[a.keyValue],n=new Set(C.value);n.has(l)?n.delete(l):n.add(l);const s=[...n];S.value=="array"?m.value=s:m.value=s.join(",")}else U(e)};oe(()=>{k.value=ue(w.value,{placement:"bottom-start",content:q.value,allowHTML:!0,interactive:!0,animation:"",duration:[0,0],offset:[0,-2],trigger:"manual",maxWidth:"unset",onShow:te,onHide:le})});const ne=()=>N.value.length==1&&!S.value?U(N.value[0]):void 0;return(e,t)=>(f(),p("comp-combo",null,[o(c)?(f(),p("p-disabling",{key:0,checked:e.brop(!i.value),onClick:t[0]||(t[0]=l=>i.value=!i.value)},null,8,he)):$("",!0),o(x)?(f(),p("p-label",{key:1,style:b(o(Y)),onClick:t[1]||(t[1]=l=>o(c)&&(i.value=!i.value))},H(o(x)),5)):$("",!0),y("p-value",{ref_key:"domValue",ref:w,"hide-outline":e.brop(F.value),only:e.brop(!o(c)&&!o(x)),onClick:t[2]||(t[2]=l=>!i.value&&!o(P)&&ae())},[y("input",{ref_key:"domValue",ref:w,value:o(ee),style:b({textAlign:u.align}),placeholder:u.place,tabindex:u.tab,readonly:!0,disabled:i.value},null,12,Se)],8,be),y("p-drop",{ref_key:"domDrop",ref:q,tabindex:"0",style:b({width:E.value,minWidth:T.value})},[ie(y("p-filter",null,[ke,de(me,{modelValue:B.value,"onUpdate:modelValue":t[3]||(t[3]=l=>B.value=l),filter:"","focus-switch":I.value,onKeypress:ce(ne,["enter"])},null,8,["modelValue","focus-switch","onKeypress"])],512),[[re,o(L)]]),o(W).length?(f(),p("p-options",ge,[we,(f(!0),p(G,null,J(o(W),(l,n)=>{var s,v;return f(),p("p-option",{key:`combo-option-${n}`,selected:e.brop(l.selected),title:(v=(s=l.data)==null?void 0:s[a.keyValue])!=null?v:h(l.data),style:b({textAlign:u.align}),onClick:V=>z(l)},H(h(l.data)),13,Ve)}),128))])):$("",!0),y("p-options",null,[_e,o(D).length?$("",!0):(f(),p("p-option",{key:0,style:b({textAlign:u.align}),disabled:""},"\u65E0\u53EF\u7528\u9009\u9879",4)),(f(!0),p(G,null,J(o(N),(l,n)=>{var s,v;return f(),p("p-option",{key:`combo-option-${n}`,selected:e.brop(l.selected),title:(v=(s=l.data)==null?void 0:s[a.keyValue])!=null?v:h(l.data),style:b({textAlign:u.align}),onClick:V=>z(l)},H(h(l.data)),13,$e)}),128))])],4)]))}},De=se(xe,[["__scopeId","data-v-92562334"]]);export{De as default};
